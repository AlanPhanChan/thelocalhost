---
date: 2020-12-31
title:
  Globally Style the Gatsby Default Starter with styled-components v5
tags:
  ['information', 'learning', 'gatsby', 'guide', 'mdx', 'markdown']
published: true
cover: ./cover.jpg
coverCredit: Photo by Jeremy Bishop on Unsplash
---

I'm going to go over globally styling the Gatsby Default Starter with
styled-components v5, I've done this in the [past with
styled-components v4] but there's been a change in v5 that I want to
document.

I'll be swapping out the styles included with a CSS reset and adding
in global style with the styled-components `createGlobalStyle` helper
function and also adding in the styled-components theme provider.

```bash
npx gatsby new gatsby-starter-styled-components
```

## Install dependencies

I'm using yarn, you can use npm

```bash
yarn add gatsby-plugin-styled-components \
  styled-components \
  babel-plugin-styled-components \
  styled-reset
```

## Configure `gatsby-plugin-styled-components` and `createGlobalStyle`

Pop `gatsby-plugin-styled-components` into the `gatsby-config.js` file
`plugins` array:

```js {2}
  plugins: [
    `gatsby-plugin-styled-components`,
    `gatsby-plugin-react-helmet`,
    {
```

Create a `global-style.js` file in `src/theme` then import the
styled-components helper function `createGlobalStyle`.

The base styles go in here, the `styled-reset` is optional.

```jsx {2,5}
import { createGlobalStyle } from 'styled-components';
import reset from 'styled-reset';

export const GlobalStyle = createGlobalStyle`
  ${reset}

  *, *:before, *:after {
    box-sizing: border-box;
  }
  html {
    box-sizing: border-box;
    scroll-behavior: smooth;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: 16px;
    color: '#1a202c';
  }
  body {
    line-height: 1.5;
    letter-spacing: 0;
    background-color: '#f7fafc';
  }
`;
```

## Remove current styling

## Place `GlobalStyle` at the top of your React tree üå≥

I'm adding this as high up the component tree as possible so that the
global styles will affect everything that is 'underneath' it.

In the case of the Gatsby Default Starter you'll notice that the
`<Layout>` component wraps a the `index.js` page, `page-2.js` and the
`404.js` page so adding the `<GlobalStyle />` component here is a
sound option.

There is an alternative to adding it to the layout and that is to use
the Gatsby Browser and Gatsby SSR API [wrapRootElement].

If I add in the following code to `gatsby-browser.js` the styles are
applied.

```js
import React from 'react';
import Layout from './src/components/layout';
import { GlobalStyle } from './src/theme/global-style';

export const wrapRootElement = ({ element }) => (
  <>
    <GlobalStyle />
    <Layout>{element}</Layout>
  </>
);
```

I also have a double header, that's because the layout component is
still wrapping the index page, page 2 and the 404 page. Remove the
layout component from those locations so I have it in one place to
manage.

## Make a Root Wrapper to keep things DRY üåµ

I also need to add the same code into `gatsby-ssr.js` so so that the
styles are rendered on the server when the site is built.

Rather than have the code duplicated in the two files I'll create a
`root-wrapper.js` file _(you can call it what you like!)_ and add it
to the root of the project. I'll import that into both the
`gatsby-browser.js` and `gatsby-ssr.js` files:

```js
import { wrapRootElement as wrap } from './root-wrapper';

export const wrapRootElement = wrap;
```

## Global fonts with `gatsby-plugin-google-fonts`

Onto the main reason for this post, with the [v5 release] of
styled-components the use of `@imports` in `createGlobalStyle` isn't
working, (that approach is [detailed here]) it's recommended that you
embed these into your HTML index file, etc.

> NOTE: At this time we recommend not using @import inside of
> `createGlobalStyle`. We're working on better behavior for this
> functionality but it just doesn't really work at the moment and it's
> better if you just embed these imports in your HTML index file, etc.

But! As I'm using Gatsby, of course, _**"There's a Plugin For
That‚Ñ¢Ô∏è"**_ so I'm going to use `gatsby-plugin-google-fonts` for this,
I'm using this in place of `gatsby-plugin-web-font-loader` because it
uses `display=swap`.

```bash
yarn add gatsby-plugin-google-fonts
```

Configure, I'll add three fonts, sans, sans serif and monospace to the
Gatsby plugin array in `gatsby-config.js`:

```js
{
  resolve: `gatsby-plugin-google-fonts`,
  options: {
    fonts: [
      `cambay\:400,700`,
      `arvo\:400,700`,
      `ibm plex mono\:400,700`,
    ],
    display: 'swap',
  },
},
```

I can now use these fonts throughout my site.

## styled-components Theme provider

The styled-components ThemeProvider

<!-- Links -->

[past with styled-components v4]:
  https://thelocalhost.blog/2018/11/29/gatsby-starter-to-styled-components/
[wraprootelement]:
  https://www.gatsbyjs.org/docs/browser-apis/#wrapRootElement
[v5 release]: https://styled-components.com/releases#v5.0.0
[detailed here]:
  http://thelocalhost.blog/2018/11/29/gatsby-starter-to-styled-components/#3-global-style
